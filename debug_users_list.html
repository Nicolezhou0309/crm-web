<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>调试 users_list 表</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>调试 users_list 表</h1>
    <button onclick="checkUsersList()">检查现有数据</button>
    <button onclick="createTestGroup()">创建测试销售组</button>
    <div id="result"></div>

    <script>
        // 初始化 Supabase 客户端
        const supabaseUrl = 'https://your-project.supabase.co'; // 请替换为您的项目URL
        const supabaseKey = 'your-anon-key'; // 请替换为您的匿名密钥
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        async function checkUsersList() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>正在检查数据...</p>';

            try {
                const { data, error } = await supabase
                    .from('users_list')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) {
                    resultDiv.innerHTML = `<p style="color: red;">错误: ${error.message}</p>`;
                } else {
                    resultDiv.innerHTML = `
                        <p style="color: green;">成功获取 ${data.length} 条记录</p>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">异常: ${error.message}</p>`;
            }
        }

        async function createTestGroup() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>正在创建测试销售组...</p>';

            try {
                const testGroup = {
                    groupname: '测试销售组_' + Date.now(),
                    description: '测试用的销售组',
                    list: [1, 2, 3],
                    allocation: 'round_robin',
                    enable_quality_control: false,
                    enable_community_matching: true
                };

                const { data, error } = await supabase
                    .from('users_list')
                    .insert([testGroup])
                    .select()
                    .single();

                if (error) {
                    resultDiv.innerHTML = `<p style="color: red;">创建失败: ${error.message}</p>`;
                } else {
                    resultDiv.innerHTML = `
                        <p style="color: green;">创建成功!</p>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">创建异常: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html> 