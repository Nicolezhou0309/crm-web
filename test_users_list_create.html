<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试销售组创建</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>测试销售组创建功能</h1>
    <button onclick="testCreateGroup()">测试创建销售组</button>
    <div id="result"></div>

    <script>
        // 初始化 Supabase 客户端
        const supabaseUrl = 'https://your-project.supabase.co'; // 请替换为您的项目URL
        const supabaseKey = 'your-anon-key'; // 请替换为您的匿名密钥
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        async function testCreateGroup() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>正在测试...</p>';

            try {
                // 测试数据
                const testGroup = {
                    groupname: '测试销售组_' + Date.now(),
                    description: '测试用的销售组',
                    list: [1, 2, 3], // 假设的用户ID
                    allocation: 'round_robin',
                    enable_quality_control: false,
                    enable_community_matching: true
                };

                console.log('测试数据:', testGroup);

                // 尝试创建销售组
                const { data, error } = await supabase
                    .from('users_list')
                    .insert([testGroup])
                    .select()
                    .single();

                console.log('Supabase响应:', { data, error });

                if (error) {
                    resultDiv.innerHTML = `<p style="color: red;">错误: ${error.message}</p>`;
                    console.error('创建失败:', error);
                } else {
                    resultDiv.innerHTML = `<p style="color: green;">成功创建销售组: ${JSON.stringify(data, null, 2)}</p>`;
                    console.log('创建成功:', data);
                }
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">异常: ${error.message}</p>`;
                console.error('测试异常:', error);
            }
        }
    </script>
</body>
</html> 