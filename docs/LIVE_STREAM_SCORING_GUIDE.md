# 直播评分系统使用指南

## 功能概述

直播评分系统为直播报名表添加了评分功能，支持动态可配置的评分规则，通过右抽屉界面进行评分操作。

## 系统架构

### 数据库设计

1. **在 `live_stream_schedules` 表中添加评分字段**：
   - `scoring_data` (JSONB): 存储评分数据
   - `scoring_status` (VARCHAR): 评分状态
   - `scored_by` (BIGINT): 评分人ID
   - `scored_at` (TIMESTAMP): 评分时间

2. **使用现有的 `Selection` 表存储评分选项**：
   - 开播准备选项
   - 直播状态选项
   - 讲解话术选项
   - 出勤情况选项
   - 运镜技巧选项

### 评分维度

1. **开播准备** (权重: 1.0)
   - 开播即出镜开始讲解，没有拖延 (10分)
   - 开播后房间内适当调整，1分钟内开始讲解 (5.5分)
   - 在办公室开播/开播后闲聊，1分钟内未开始讲解 (3分)

2. **直播状态** (权重: 1.0)
   - 进入直播间观众口播欢迎，状态饱满 (10分)
   - 状态平淡无明显优点 (5.5分)
   - 长时间坐着/态度懒散/说话无精打采 (0分)

3. **讲解话术** (权重: 1.0)
   - 话术流畅严谨有吸引力，讲解认真全面 (10分)
   - 每10分钟介绍一遍房间，介绍完整但不够严谨仔细 (5.5分)
   - 持续15分钟只读评论不介绍房间/冷场或互相聊天超过5分钟 (3分)

4. **出勤情况** (权重: 1.0)
   - 准时开播并播满120分钟，中途未离开 (9分)
   - 因上场拖延迟到，未满120分钟/中途缺席10分钟以内 (5.5分)
   - 上场无拖延情况下迟到/无故直播时长未满120分钟/中途缺席超过10分钟 (0分)

5. **运镜技巧** (权重: 1.0)
   - 构图美观横平竖直，人物居中运镜丝滑，镜头0.5倍 (10分)
   - 构图略微倾斜，运镜轻微摇晃，镜头0.5倍 (5.5分)
   - 人物长时间不在镜头/画面角度刁钻/运镜摇晃严重/镜头未开0.5倍 (3分)

## 使用方法

### 1. 访问评分演示页面

在导航菜单中点击"评分演示"，或直接访问 `/scoring-demo` 路径。

### 2. 进行评分操作

1. 点击任意直播场次卡片
2. 在右侧抽屉中查看评分界面
3. 选择各维度的评分选项
4. 系统自动计算总分和平均分
5. 添加评分备注（可选）
6. 保存或提交评分

### 3. 评分状态

- **未评分**: 直播完成后尚未进行评分
- **已评分**: 已完成评分但未审核
- **已审核**: 评分已审核通过

## 技术实现

### 前端组件

- `LiveStreamScoringDrawer.tsx`: 评分抽屉组件
- `ScoringDemo.tsx`: 评分演示页面
- `scoringApi.ts`: 评分相关API
- `scoring.ts`: 评分类型定义

### 数据结构

```typescript
interface ScoringData {
  scoring_version: string;
  evaluator_id: number;
  evaluation_date: string;
  dimensions: Record<string, {
    selected_option: string;
    score: number;
    notes?: string;
  }>;
  calculation: {
    total_score: number;
    average_score: number;
    weighted_average: number;
  };
  metadata: {
    created_at: string;
    updated_at: string;
    evaluation_notes?: string;
  };
}
```

### API接口

- `getScoringDimensions()`: 获取评分维度配置
- `getScoringData(scheduleId)`: 获取评分数据
- `saveScoringData(scheduleId, data)`: 保存评分数据
- `submitScoring(scheduleId)`: 提交评分
- `getScoredSchedules()`: 获取已评分直播列表

## 扩展功能

### 1. 评分规则配置

可以通过数据库配置评分维度和选项，支持动态调整评分标准。

### 2. 评分历史

记录评分历史，支持查看评分详情和修改记录。

### 3. 评分统计

提供评分统计分析，包括平均分、趋势分析等。

### 4. 权限控制

支持评分权限控制，确保只有授权人员可以进行评分操作。

## 注意事项

1. 评分数据使用JSONB格式存储，确保数据完整性和查询性能
2. 评分状态变更需要相应的权限控制
3. 评分历史记录便于审计和追溯
4. 响应式设计确保在不同设备上的良好体验

## 后续开发计划

1. 集成到现有直播系统中
2. 添加评分审核流程
3. 实现评分统计分析功能
4. 支持批量评分操作
5. 添加评分模板功能 